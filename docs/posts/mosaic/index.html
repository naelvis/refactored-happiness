<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	
	<script src="https://rstudio.github.io/leaflet/libs/jquery/jquery.min.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/bootstrap/css/flatly.min.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/bootstrap/js/bootstrap.min.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/bootstrap/shim/html5shiv.min.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/bootstrap/shim/respond.min.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/navigation/tabsets.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/highlightjs/default.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/highlightjs/highlight.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/htmlwidgets/htmlwidgets.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/leaflet/leaflet.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/leaflet/leaflet.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/leafletfix/leafletfix.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/Proj4Leaflet/proj4-compressed.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/Proj4Leaflet/proj4leaflet.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-binding/leaflet.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/leaflet-measure/leaflet-measure.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-measure/leaflet-measure.min.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-graticule/L.Graticule.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-graticule/Graticule-binding.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-terminator/L.Terminator.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-terminator/Terminator-binding.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-providers/leaflet-providers_1.9.0.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/leaflet-minimap/Control.MiniMap.min.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-minimap/Control.MiniMap.min.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-minimap/Minimap-binding.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/leaflet-easybutton/easy-button.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-easybutton/easy-button.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-easybutton/EasyButton-binding.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/leaflet-markercluster/MarkerCluster.css" rel="stylesheet" />
	<link href="https://rstudio.github.io/leaflet/libs/leaflet-markercluster/MarkerCluster.Default.css" rel="stylesheet" />
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-markercluster/leaflet.markercluster.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-markercluster/leaflet.markercluster.freezable.js"></script>
	<script src="https://rstudio.github.io/leaflet/libs/leaflet-markercluster/leaflet.markercluster.layersupport.js"></script>
	<link href="https://rstudio.github.io/leaflet/libs/ionicons/ionicons.min.css" rel="stylesheet" />
	
	
	
	
	<script src="https://dieghernan.github.io/js/leaflet_extras/lfx-heat/lfx-heat-prod.js"></script>
	<script src="https://dieghernan.github.io/js/leaflet_extras/lfx-heat/lfx-heat-bindings.js"></script>
	
  <title>Mosaic &middot; refactored happiness</title>
  <meta name="description" content="" />
  <meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="r-h">
<meta property="og:description" content="my blog">
<meta property="og:url" content="https://naelvis.github.io/refactored-happiness/posts/mosaic/">
<meta property="og:site_name" content="r-h">
<meta property="og:image" content="https://naelvis.github.io/refactored-happiness/">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="r-h">
<meta name="twitter:description" content="my blog">
<meta name="twitter:site" content="https://naelvis.github.io/refactored-happiness/">
<meta name="twitter:creator" content="">
<meta name="twitter:image" content="https://naelvis.github.io/refactored-happiness/">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  
  
  
  
  <link href="https://naelvis.github.io/refactored-happiness/css/concated.min.css" rel="stylesheet">
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-176386889-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  <style>
    body {
      background: #ecedef url("https://naelvis.github.io/refactored-happiness/img/236_cut.png") repeat;
    }
  </style>

</head>

  <body class="single-body">
    <nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="https://naelvis.github.io/refactored-happiness/" class="nav-text">r-h</a></h1>
  <div class="hamburger-menu">
    <button onclick="hamburgerMenuPressed.call(this)" aria-haspopup="true" aria-expanded="false" aria-controls="menu" aria-label="Menu">
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="https://naelvis.github.io/refactored-happiness/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://naelvis.github.io/refactored-happiness/post/cose/" class="hamburger-menu-overlay-link">Cose</a></li>
      <li><a href="https://naelvis.github.io/refactored-happiness/post/places/" class="hamburger-menu-overlay-link">places</a></li>
      <li><a href="https://naelvis.github.io/refactored-happiness/post/legenda/" class="hamburger-menu-overlay-link">Legenda</a></li>
      <li><a href="https://naelvis.github.io/refactored-happiness/post/about/" class="hamburger-menu-overlay-link">About</a></li>
      
      <li><a href="https://naelvis.github.io/refactored-happiness/categories/code/" class="hamburger-menu-overlay-link">Code</a></li>
      
      <li><a href="https://naelvis.github.io/refactored-happiness/categories/lesenotizen/" class="hamburger-menu-overlay-link">Lesenotizen</a></li>
      
      <li><a href="https://naelvis.github.io/refactored-happiness/categories/poetry/" class="hamburger-menu-overlay-link">Poetry</a></li>
      
      
    </ul>
  </div>
</nav>

    <main class="content side-text-padding">
      <article class="post ">
        <header class="post-header">
          <h1 class="post-title">Mosaic</h1>
          <p class="post-date">Posted <time datetime="2021-01-05">Jan 5, 2021</time></p>
        </header>
        
        
        
<script src="https://naelvis.github.io/refactored-happiness/refactored-happiness/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>I recently opened a new repository <a href="https://github.com/naelvis/mosaic">here</a>, which an sich consists more or less of a single, chaotic script - but there is come conceptual content, so I thought I would write something down before forgetting about it.</p>
<p>The idea for the script was simple: divide an image in square tiles, then, given a list of mosaic tiles on the market, find for each tile in which the picture has been divided the <em>most suitable</em> tile on the market to represent it. So the script produces a first suggestion on how to construct a mosaic starting from any given image and number of tiles, and you can then build on that. Sounds good, right?</p>
<p>The non intuitive part is in fact formally defining “most suitable”. The naïve attempt at finding the most suitable tile could go like this:</p>
<ol style="list-style-type: decimal">
<li>Realize that every colour is a three dimensional vector (RGB);</li>
<li>Average the three components over the image tile to obtain a single vector representing it;</li>
<li>Select the mosaic tile for which the norm of the difference between the vector representing the mosaic tile and the vector representing the image tile is minimal.</li>
</ol>
<p>The fascinating fact is that this fails spectacularly, for the simple reason that the Euclidean norm is not the right norm for the RGB space (from the human eye’s, well, point of view), for whatever reasons. The problem of finding the right norm is not really easy, but luckily the question is general enough that somebody else already thought about it and found a good solution, so that you don’t need to worry too much about it.</p>
<p>What I found amusing about the solution is that it does not consist in providing the right norm, but rather in moving around every vector so that the Euclidean distance between the shifted vectors equals the correct distance for the unshifted vectors. I was working with this source image:</p>
<p><img src="https://naelvis.github.io/refactored-happiness/posts/2021-01-05-mosaic_files/input_post.png" alt="Source" />
Which shifts to this:</p>
<p><img src="https://naelvis.github.io/refactored-happiness/posts/2021-01-05-mosaic_files/shifted_post.png" alt="Shifted" />
So the plan is of course to take the image, shift it, tile it, then shift it back. Clockwise, starting up left:</p>
<p><img src="https://naelvis.github.io/refactored-happiness/posts/2021-01-05-mosaic_files/process_post.png" alt="Process" />
Here’s a comparison between the output just presented and the one obtained following the naïve approach:</p>
<p><img src="https://naelvis.github.io/refactored-happiness/posts/2021-01-05-mosaic_files/comparison_post.png" /></p>

      </article>
      
    </main>
    <nav class="end-nav side-padding">
      
      <a ontouchstart="cardPressed.call(this)" ontouchend="cardReleased.call(this)" ontouchmove="cardReleased.call(this)" 
  href="https://naelvis.github.io/refactored-happiness/posts/birds-and-frogs-f-dyson/" class="card blog-card" rel="bookmark" >
  
  <article class="card-body">
    <h2 class="card-title">Birds and frogs - F. Dyson</h2>
    <p class="card-text"></p>
    <div class="card-subtext muted-text">
      <p>Posted <time datetime="2021-01-03 13:00">Jan 3, 2021</time></p>
      <p>#Lesenotizen </p>
    </div>
  </article>
</a>
      
      <a ontouchstart="cardPressed.call(this)" ontouchend="cardReleased.call(this)" ontouchmove="cardReleased.call(this)" 
  href="https://naelvis.github.io/refactored-happiness/" class="card home-card" style="background-image: url( https://naelvis.github.io/refactored-happiness/img/boat_background.png )" rel="bookmark" >
  Home
</a>
    </nav>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
  
  <script src="https://naelvis.github.io/refactored-happiness/js/core.min.js"></script>

  </body>
</html>
